# NN_from_the_scratch
```python
import numpy as np
import pandas as pd
```


```python
X = np.genfromtxt('./data/train.csv',delimiter=',')
X = X[1:,:]
y = X[:,0]
X = X[:,1:]
X = X/256
X = X.T
y = y.tolist()
for i,a in enumerate(y):
    y[i] = [int(int(a)==i) for i in range(10)]
y = np.array(y)

N = len(X)
batchsize = 128


Xtrain,ytrain = X[:,:30000],y[:30000]
Xtest,ytest = X[:,30000:],y[30000:]
Ntrain = 30000
Ntest = len(ytest)
```


```python
def Loss(a2,y):
    return -np.log10(np.e**(a2[range(batchsize), y.argmax(axis = 1)])/np.sum(np.e**(a2),axis = 1))
```


```python
def derevative_of_Relu(x):
    return x>0

def softmax(x):
    return np.e**x/np.sum(np.e**x,axis = 0)


def train(a1,a2,w1,b1,w2,b2,X,y,epochs = 1000,alpha = 0.1):
    for i in range(epochs):
        batchindex = np.random.randint([Ntrain]*batchsize)
        batchindex2 = np.random.randint([Ntest]*batchsize)
        bX = Xtrain[:,batchindex]
        by = ytrain[batchindex]
        
        #forward prop
        a1 = w1.dot(bX) + b1
        a1 = a1*(a1>0)
        
        a2 = w2.dot(a1) + b2
        a2 = softmax(a2)
        
    
        #Backprop
        da2 = a2-by.T
        
        dw2 = 1/batchsize * np.dot(da2,a1.T)
        db2 = np.array([1/batchsize * np.sum(da2,axis = 1)]).T
        da1 = np.dot(w2.T,da2)*derevative_of_Relu(a1)
        dw1 = 1/batchsize * np.dot(da1,bX.T)
        db1 = np.array([1/batchsize * np.sum(da1,axis = 1)]).T

        w1 -= alpha*dw1
        w2 -= alpha*dw2
        b1 -= alpha*db1
        b2 -= alpha*db2
        

        print("epochs {}: acc = {}".format(i,accuracy(Xtest[:,batchindex2],ytest[batchindex2],w1,w2,b1,b2)))
    return w1,w2,b1,b2

def predict(X,w1,w2,b1,b2):
    a1 = w1.dot(X) + b1
    a1 = a1*(a1>0)
    
    a2 = w2.dot(a1) + b2
    a2 = softmax(a2)
    return a2.argmax(axis = 0)
    

def accuracy(X,y,w1,w2,b1,b2):
    #forward prop
    a1 = w1.dot(X) + b1
    a1 = a1*(a1>0)
    
    a2 = w2.dot(a1) + b2
    a2 = softmax(a2)

    return np.sum(y[range(batchsize),a2.argmax(axis = 0)]==1)/batchsize
    
    
        
```


```python
a1 = np.zeros((64,batchsize))
a2 = np.zeros((10,batchsize))

w1 = np.random.random((64,784))-0.5
w2 = np.random.random((10,64))-0.5
b1 = np.random.random((64,1))-0.5
b2 = np.random.random((10,1))-0.5
train(a1,a2,w1,b1,w2,b2,X,y);
```

    epochs 0: acc = 0.1015625
    epochs 1: acc = 0.2109375
    epochs 2: acc = 0.1640625
    epochs 3: acc = 0.28125
    epochs 4: acc = 0.265625
    epochs 5: acc = 0.28125
    epochs 6: acc = 0.40625
    epochs 7: acc = 0.3828125
    epochs 8: acc = 0.3359375
    epochs 9: acc = 0.4453125
    epochs 10: acc = 0.46875
    epochs 11: acc = 0.3828125
    epochs 12: acc = 0.4375
    epochs 13: acc = 0.46875
    epochs 14: acc = 0.53125
    epochs 15: acc = 0.484375
    epochs 16: acc = 0.5859375
    epochs 17: acc = 0.453125
    epochs 18: acc = 0.578125
    epochs 19: acc = 0.515625
    epochs 20: acc = 0.5234375
    epochs 21: acc = 0.5546875
    epochs 22: acc = 0.5625
    epochs 23: acc = 0.578125
    epochs 24: acc = 0.515625
    epochs 25: acc = 0.625
    epochs 26: acc = 0.65625
    epochs 27: acc = 0.609375
    epochs 28: acc = 0.6328125
    epochs 29: acc = 0.6484375
    epochs 30: acc = 0.5859375
    epochs 31: acc = 0.6640625
    epochs 32: acc = 0.6640625
    epochs 33: acc = 0.71875
    epochs 34: acc = 0.6015625
    epochs 35: acc = 0.6796875
    epochs 36: acc = 0.65625
    epochs 37: acc = 0.6328125
    epochs 38: acc = 0.6640625
    epochs 39: acc = 0.71875
    epochs 40: acc = 0.671875
    epochs 41: acc = 0.6484375
    epochs 42: acc = 0.71875
    epochs 43: acc = 0.6640625
    epochs 44: acc = 0.71875
    epochs 45: acc = 0.640625
    epochs 46: acc = 0.734375
    epochs 47: acc = 0.703125
    epochs 48: acc = 0.6484375
    epochs 49: acc = 0.7109375
    epochs 50: acc = 0.7109375
    epochs 51: acc = 0.7265625
    epochs 52: acc = 0.71875
    epochs 53: acc = 0.7109375
    epochs 54: acc = 0.71875
    epochs 55: acc = 0.7421875
    epochs 56: acc = 0.71875
    epochs 57: acc = 0.7734375
    epochs 58: acc = 0.765625
    epochs 59: acc = 0.6953125
    epochs 60: acc = 0.734375
    epochs 61: acc = 0.8125
    epochs 62: acc = 0.765625
    epochs 63: acc = 0.734375
    epochs 64: acc = 0.734375
    epochs 65: acc = 0.7578125
    epochs 66: acc = 0.78125
    epochs 67: acc = 0.8515625
    epochs 68: acc = 0.8359375
    epochs 69: acc = 0.7421875
    epochs 70: acc = 0.8203125
    epochs 71: acc = 0.765625
    epochs 72: acc = 0.828125
    epochs 73: acc = 0.8203125
    epochs 74: acc = 0.765625
    epochs 75: acc = 0.75
    epochs 76: acc = 0.796875
    epochs 77: acc = 0.8203125
    epochs 78: acc = 0.765625
    epochs 79: acc = 0.8046875
    epochs 80: acc = 0.7890625
    epochs 81: acc = 0.7890625
    epochs 82: acc = 0.828125
    epochs 83: acc = 0.765625
    epochs 84: acc = 0.7734375
    epochs 85: acc = 0.734375
    epochs 86: acc = 0.734375
    epochs 87: acc = 0.8359375
    epochs 88: acc = 0.7421875
    epochs 89: acc = 0.734375
    epochs 90: acc = 0.75
    epochs 91: acc = 0.7421875
    epochs 92: acc = 0.7734375
    epochs 93: acc = 0.7890625
    epochs 94: acc = 0.7421875
    epochs 95: acc = 0.8515625
    epochs 96: acc = 0.828125
    epochs 97: acc = 0.7265625
    epochs 98: acc = 0.796875
    epochs 99: acc = 0.84375
    epochs 100: acc = 0.828125
    epochs 101: acc = 0.8515625
    epochs 102: acc = 0.8125
    epochs 103: acc = 0.8828125
    epochs 104: acc = 0.7734375
    epochs 105: acc = 0.78125
    epochs 106: acc = 0.8046875
    epochs 107: acc = 0.8203125
    epochs 108: acc = 0.7890625
    epochs 109: acc = 0.7421875
    epochs 110: acc = 0.8046875
    epochs 111: acc = 0.8046875
    epochs 112: acc = 0.859375
    epochs 113: acc = 0.78125
    epochs 114: acc = 0.8515625
    epochs 115: acc = 0.796875
    epochs 116: acc = 0.8671875
    epochs 117: acc = 0.828125
    epochs 118: acc = 0.8203125
    epochs 119: acc = 0.8359375
    epochs 120: acc = 0.7734375
    epochs 121: acc = 0.8515625
    epochs 122: acc = 0.8359375
    epochs 123: acc = 0.7734375
    epochs 124: acc = 0.8359375
    epochs 125: acc = 0.7890625
    epochs 126: acc = 0.765625
    epochs 127: acc = 0.875
    epochs 128: acc = 0.8046875
    epochs 129: acc = 0.90625
    epochs 130: acc = 0.8359375
    epochs 131: acc = 0.84375
    epochs 132: acc = 0.828125
    epochs 133: acc = 0.890625
    epochs 134: acc = 0.8984375
    epochs 135: acc = 0.8125
    epochs 136: acc = 0.8046875
    epochs 137: acc = 0.828125
    epochs 138: acc = 0.8515625
    epochs 139: acc = 0.84375
    epochs 140: acc = 0.90625
    epochs 141: acc = 0.8359375
    epochs 142: acc = 0.859375
    epochs 143: acc = 0.8203125
    epochs 144: acc = 0.8046875
    epochs 145: acc = 0.859375
    epochs 146: acc = 0.8125
    epochs 147: acc = 0.8125
    epochs 148: acc = 0.7734375
    epochs 149: acc = 0.8828125
    epochs 150: acc = 0.796875
    epochs 151: acc = 0.84375
    epochs 152: acc = 0.8203125
    epochs 153: acc = 0.8046875
    epochs 154: acc = 0.8359375
    epochs 155: acc = 0.8828125
    epochs 156: acc = 0.84375
    epochs 157: acc = 0.8046875
    epochs 158: acc = 0.84375
    epochs 159: acc = 0.8125
    epochs 160: acc = 0.8125
    epochs 161: acc = 0.8125
    epochs 162: acc = 0.828125
    epochs 163: acc = 0.8359375
    epochs 164: acc = 0.7890625
    epochs 165: acc = 0.875
    epochs 166: acc = 0.8125
    epochs 167: acc = 0.8515625
    epochs 168: acc = 0.84375
    epochs 169: acc = 0.8125
    epochs 170: acc = 0.8359375
    epochs 171: acc = 0.8359375
    epochs 172: acc = 0.8671875
    epochs 173: acc = 0.8046875
    epochs 174: acc = 0.828125
    epochs 175: acc = 0.8125
    epochs 176: acc = 0.8359375
    epochs 177: acc = 0.8203125
    epochs 178: acc = 0.8359375
    epochs 179: acc = 0.8046875
    epochs 180: acc = 0.8359375
    epochs 181: acc = 0.8359375
    epochs 182: acc = 0.84375
    epochs 183: acc = 0.8125
    epochs 184: acc = 0.8515625
    epochs 185: acc = 0.8203125
    epochs 186: acc = 0.828125
    epochs 187: acc = 0.859375
    epochs 188: acc = 0.7890625
    epochs 189: acc = 0.7578125
    epochs 190: acc = 0.875
    epochs 191: acc = 0.875
    epochs 192: acc = 0.90625
    epochs 193: acc = 0.796875
    epochs 194: acc = 0.84375
    epochs 195: acc = 0.8671875
    epochs 196: acc = 0.8515625
    epochs 197: acc = 0.84375
    epochs 198: acc = 0.859375
    epochs 199: acc = 0.828125
    epochs 200: acc = 0.8125
    epochs 201: acc = 0.734375
    epochs 202: acc = 0.8125
    epochs 203: acc = 0.8984375
    epochs 204: acc = 0.875
    epochs 205: acc = 0.875
    epochs 206: acc = 0.8515625
    epochs 207: acc = 0.796875
    epochs 208: acc = 0.84375
    epochs 209: acc = 0.8515625
    epochs 210: acc = 0.875
    epochs 211: acc = 0.8203125
    epochs 212: acc = 0.875
    epochs 213: acc = 0.8828125
    epochs 214: acc = 0.875
    epochs 215: acc = 0.8828125
    epochs 216: acc = 0.9140625
    epochs 217: acc = 0.828125
    epochs 218: acc = 0.8671875
    epochs 219: acc = 0.8046875
    epochs 220: acc = 0.8984375
    epochs 221: acc = 0.875
    epochs 222: acc = 0.90625
    epochs 223: acc = 0.875
    epochs 224: acc = 0.859375
    epochs 225: acc = 0.7890625
    epochs 226: acc = 0.8125
    epochs 227: acc = 0.8046875
    epochs 228: acc = 0.828125
    epochs 229: acc = 0.828125
    epochs 230: acc = 0.8828125
    epochs 231: acc = 0.8671875
    epochs 232: acc = 0.84375
    epochs 233: acc = 0.8046875
    epochs 234: acc = 0.8515625
    epochs 235: acc = 0.828125
    epochs 236: acc = 0.8671875
    epochs 237: acc = 0.8828125
    epochs 238: acc = 0.84375
    epochs 239: acc = 0.84375
    epochs 240: acc = 0.875
    epochs 241: acc = 0.90625
    epochs 242: acc = 0.8515625
    epochs 243: acc = 0.8515625
    epochs 244: acc = 0.859375
    epochs 245: acc = 0.8671875
    epochs 246: acc = 0.859375
    epochs 247: acc = 0.8125
    epochs 248: acc = 0.7734375
    epochs 249: acc = 0.8046875
    epochs 250: acc = 0.8828125
    epochs 251: acc = 0.796875
    epochs 252: acc = 0.859375
    epochs 253: acc = 0.8671875
    epochs 254: acc = 0.8671875
    epochs 255: acc = 0.9375
    epochs 256: acc = 0.859375
    epochs 257: acc = 0.8984375
    epochs 258: acc = 0.8828125
    epochs 259: acc = 0.8515625
    epochs 260: acc = 0.796875
    epochs 261: acc = 0.84375
    epochs 262: acc = 0.890625
    epochs 263: acc = 0.859375
    epochs 264: acc = 0.875
    epochs 265: acc = 0.875
    epochs 266: acc = 0.921875
    epochs 267: acc = 0.78125
    epochs 268: acc = 0.8828125
    epochs 269: acc = 0.8671875
    epochs 270: acc = 0.875
    epochs 271: acc = 0.8671875
    epochs 272: acc = 0.8671875
    epochs 273: acc = 0.8671875
    epochs 274: acc = 0.828125
    epochs 275: acc = 0.8359375
    epochs 276: acc = 0.859375
    epochs 277: acc = 0.8671875
    epochs 278: acc = 0.890625
    epochs 279: acc = 0.875
    epochs 280: acc = 0.84375
    epochs 281: acc = 0.8203125
    epochs 282: acc = 0.8515625
    epochs 283: acc = 0.859375
    epochs 284: acc = 0.8359375
    epochs 285: acc = 0.84375
    epochs 286: acc = 0.7890625
    epochs 287: acc = 0.8671875
    epochs 288: acc = 0.859375
    epochs 289: acc = 0.8828125
    epochs 290: acc = 0.8359375
    epochs 291: acc = 0.8984375
    epochs 292: acc = 0.875
    epochs 293: acc = 0.859375
    epochs 294: acc = 0.859375
    epochs 295: acc = 0.8359375
    epochs 296: acc = 0.859375
    epochs 297: acc = 0.84375
    epochs 298: acc = 0.828125
    epochs 299: acc = 0.8515625
    epochs 300: acc = 0.890625
    epochs 301: acc = 0.84375
    epochs 302: acc = 0.8671875
    epochs 303: acc = 0.8984375
    epochs 304: acc = 0.875
    epochs 305: acc = 0.8515625
    epochs 306: acc = 0.8828125
    epochs 307: acc = 0.8828125
    epochs 308: acc = 0.8828125
    epochs 309: acc = 0.8828125
    epochs 310: acc = 0.8515625
    epochs 311: acc = 0.8046875
    epochs 312: acc = 0.8671875
    epochs 313: acc = 0.875
    epochs 314: acc = 0.8203125
    epochs 315: acc = 0.8359375
    epochs 316: acc = 0.8671875
    epochs 317: acc = 0.8984375
    epochs 318: acc = 0.828125
    epochs 319: acc = 0.8359375
    epochs 320: acc = 0.84375
    epochs 321: acc = 0.8671875
    epochs 322: acc = 0.859375
    epochs 323: acc = 0.90625
    epochs 324: acc = 0.921875
    epochs 325: acc = 0.8828125
    epochs 326: acc = 0.8984375
    epochs 327: acc = 0.8125
    epochs 328: acc = 0.90625
    epochs 329: acc = 0.8671875
    epochs 330: acc = 0.890625
    epochs 331: acc = 0.8125
    epochs 332: acc = 0.828125
    epochs 333: acc = 0.859375
    epochs 334: acc = 0.90625
    epochs 335: acc = 0.828125
    epochs 336: acc = 0.859375
    epochs 337: acc = 0.90625
    epochs 338: acc = 0.8359375
    epochs 339: acc = 0.8671875
    epochs 340: acc = 0.8515625
    epochs 341: acc = 0.8828125
    epochs 342: acc = 0.9296875
    epochs 343: acc = 0.90625
    epochs 344: acc = 0.875
    epochs 345: acc = 0.90625
    epochs 346: acc = 0.9140625
    epochs 347: acc = 0.890625
    epochs 348: acc = 0.859375
    epochs 349: acc = 0.8984375
    epochs 350: acc = 0.8671875
    epochs 351: acc = 0.8203125
    epochs 352: acc = 0.828125
    epochs 353: acc = 0.90625
    epochs 354: acc = 0.859375
    epochs 355: acc = 0.8671875
    epochs 356: acc = 0.859375
    epochs 357: acc = 0.8671875
    epochs 358: acc = 0.84375
    epochs 359: acc = 0.9140625
    epochs 360: acc = 0.8203125
    epochs 361: acc = 0.859375
    epochs 362: acc = 0.8828125
    epochs 363: acc = 0.890625
    epochs 364: acc = 0.875
    epochs 365: acc = 0.859375
    epochs 366: acc = 0.8515625
    epochs 367: acc = 0.859375
    epochs 368: acc = 0.8828125
    epochs 369: acc = 0.8984375
    epochs 370: acc = 0.890625
    epochs 371: acc = 0.8515625
    epochs 372: acc = 0.8671875
    epochs 373: acc = 0.859375
    epochs 374: acc = 0.875
    epochs 375: acc = 0.8203125
    epochs 376: acc = 0.859375
    epochs 377: acc = 0.8828125
    epochs 378: acc = 0.90625
    epochs 379: acc = 0.8984375
    epochs 380: acc = 0.84375
    epochs 381: acc = 0.875
    epochs 382: acc = 0.84375
    epochs 383: acc = 0.8828125
    epochs 384: acc = 0.8828125
    epochs 385: acc = 0.8671875
    epochs 386: acc = 0.90625
    epochs 387: acc = 0.90625
    epochs 388: acc = 0.8828125
    epochs 389: acc = 0.9296875
    epochs 390: acc = 0.8046875
    epochs 391: acc = 0.8671875
    epochs 392: acc = 0.8828125
    epochs 393: acc = 0.828125
    epochs 394: acc = 0.9140625
    epochs 395: acc = 0.859375
    epochs 396: acc = 0.8671875
    epochs 397: acc = 0.875
    epochs 398: acc = 0.84375
    epochs 399: acc = 0.90625
    epochs 400: acc = 0.8984375
    epochs 401: acc = 0.8671875
    epochs 402: acc = 0.9140625
    epochs 403: acc = 0.875
    epochs 404: acc = 0.859375
    epochs 405: acc = 0.890625
    epochs 406: acc = 0.8984375
    epochs 407: acc = 0.9296875
    epochs 408: acc = 0.859375
    epochs 409: acc = 0.8828125
    epochs 410: acc = 0.875
    epochs 411: acc = 0.8828125
    epochs 412: acc = 0.8359375
    epochs 413: acc = 0.8828125
    epochs 414: acc = 0.890625
    epochs 415: acc = 0.8828125
    epochs 416: acc = 0.9140625
    epochs 417: acc = 0.8046875
    epochs 418: acc = 0.8671875
    epochs 419: acc = 0.8671875
    epochs 420: acc = 0.8984375
    epochs 421: acc = 0.8515625
    epochs 422: acc = 0.890625
    epochs 423: acc = 0.90625
    epochs 424: acc = 0.84375
    epochs 425: acc = 0.921875
    epochs 426: acc = 0.8828125
    epochs 427: acc = 0.9453125
    epochs 428: acc = 0.8828125
    epochs 429: acc = 0.8671875
    epochs 430: acc = 0.8984375
    epochs 431: acc = 0.8828125
    epochs 432: acc = 0.859375
    epochs 433: acc = 0.8671875
    epochs 434: acc = 0.8984375
    epochs 435: acc = 0.875
    epochs 436: acc = 0.875
    epochs 437: acc = 0.859375
    epochs 438: acc = 0.90625
    epochs 439: acc = 0.90625
    epochs 440: acc = 0.8671875
    epochs 441: acc = 0.9375
    epochs 442: acc = 0.8984375
    epochs 443: acc = 0.9375
    epochs 444: acc = 0.8828125
    epochs 445: acc = 0.8515625
    epochs 446: acc = 0.90625
    epochs 447: acc = 0.8828125
    epochs 448: acc = 0.890625
    epochs 449: acc = 0.9140625
    epochs 450: acc = 0.8359375
    epochs 451: acc = 0.828125
    epochs 452: acc = 0.8984375
    epochs 453: acc = 0.8828125
    epochs 454: acc = 0.9140625
    epochs 455: acc = 0.90625
    epochs 456: acc = 0.8828125
    epochs 457: acc = 0.90625
    epochs 458: acc = 0.8984375
    epochs 459: acc = 0.8984375
    epochs 460: acc = 0.875
    epochs 461: acc = 0.8828125
    epochs 462: acc = 0.9296875
    epochs 463: acc = 0.9453125
    epochs 464: acc = 0.9140625
    epochs 465: acc = 0.8984375
    epochs 466: acc = 0.890625
    epochs 467: acc = 0.8984375
    epochs 468: acc = 0.9140625
    epochs 469: acc = 0.875
    epochs 470: acc = 0.8671875
    epochs 471: acc = 0.8515625
    epochs 472: acc = 0.890625
    epochs 473: acc = 0.8828125
    epochs 474: acc = 0.8515625
    epochs 475: acc = 0.8359375
    epochs 476: acc = 0.9375
    epochs 477: acc = 0.890625
    epochs 478: acc = 0.9140625
    epochs 479: acc = 0.828125
    epochs 480: acc = 0.8671875
    epochs 481: acc = 0.921875
    epochs 482: acc = 0.890625
    epochs 483: acc = 0.90625
    epochs 484: acc = 0.90625
    epochs 485: acc = 0.8671875
    epochs 486: acc = 0.90625
    epochs 487: acc = 0.9453125
    epochs 488: acc = 0.8984375
    epochs 489: acc = 0.8984375
    epochs 490: acc = 0.84375
    epochs 491: acc = 0.9140625
    epochs 492: acc = 0.90625
    epochs 493: acc = 0.84375
    epochs 494: acc = 0.8671875
    epochs 495: acc = 0.859375
    epochs 496: acc = 0.859375
    epochs 497: acc = 0.859375
    epochs 498: acc = 0.90625
    epochs 499: acc = 0.859375
    epochs 500: acc = 0.9140625
    epochs 501: acc = 0.9140625
    epochs 502: acc = 0.8671875
    epochs 503: acc = 0.828125
    epochs 504: acc = 0.8984375
    epochs 505: acc = 0.921875
    epochs 506: acc = 0.8671875
    epochs 507: acc = 0.890625
    epochs 508: acc = 0.90625
    epochs 509: acc = 0.875
    epochs 510: acc = 0.890625
    epochs 511: acc = 0.828125
    epochs 512: acc = 0.859375
    epochs 513: acc = 0.8984375
    epochs 514: acc = 0.9296875
    epochs 515: acc = 0.890625
    epochs 516: acc = 0.921875
    epochs 517: acc = 0.90625
    epochs 518: acc = 0.8984375
    epochs 519: acc = 0.859375
    epochs 520: acc = 0.84375
    epochs 521: acc = 0.9296875
    epochs 522: acc = 0.9375
    epochs 523: acc = 0.9140625
    epochs 524: acc = 0.8671875
    epochs 525: acc = 0.8828125
    epochs 526: acc = 0.875
    epochs 527: acc = 0.875
    epochs 528: acc = 0.90625
    epochs 529: acc = 0.90625
    epochs 530: acc = 0.8828125
    epochs 531: acc = 0.84375
    epochs 532: acc = 0.90625
    epochs 533: acc = 0.8828125
    epochs 534: acc = 0.921875
    epochs 535: acc = 0.9453125
    epochs 536: acc = 0.8828125
    epochs 537: acc = 0.8515625
    epochs 538: acc = 0.9140625
    epochs 539: acc = 0.90625
    epochs 540: acc = 0.8984375
    epochs 541: acc = 0.8984375
    epochs 542: acc = 0.890625
    epochs 543: acc = 0.890625
    epochs 544: acc = 0.84375
    epochs 545: acc = 0.9140625
    epochs 546: acc = 0.8828125
    epochs 547: acc = 0.890625
    epochs 548: acc = 0.8515625
    epochs 549: acc = 0.90625
    epochs 550: acc = 0.875
    epochs 551: acc = 0.890625
    epochs 552: acc = 0.859375
    epochs 553: acc = 0.8984375
    epochs 554: acc = 0.859375
    epochs 555: acc = 0.8828125
    epochs 556: acc = 0.8828125
    epochs 557: acc = 0.875
    epochs 558: acc = 0.84375
    epochs 559: acc = 0.875
    epochs 560: acc = 0.859375
    epochs 561: acc = 0.8984375
    epochs 562: acc = 0.90625
    epochs 563: acc = 0.921875
    epochs 564: acc = 0.921875
    epochs 565: acc = 0.8359375
    epochs 566: acc = 0.84375
    epochs 567: acc = 0.8984375
    epochs 568: acc = 0.828125
    epochs 569: acc = 0.875
    epochs 570: acc = 0.8828125
    epochs 571: acc = 0.8828125
    epochs 572: acc = 0.859375
    epochs 573: acc = 0.875
    epochs 574: acc = 0.90625
    epochs 575: acc = 0.9453125
    epochs 576: acc = 0.8515625
    epochs 577: acc = 0.890625
    epochs 578: acc = 0.8984375
    epochs 579: acc = 0.828125
    epochs 580: acc = 0.921875
    epochs 581: acc = 0.8828125
    epochs 582: acc = 0.9140625
    epochs 583: acc = 0.8828125
    epochs 584: acc = 0.8984375
    epochs 585: acc = 0.890625
    epochs 586: acc = 0.8828125
    epochs 587: acc = 0.859375
    epochs 588: acc = 0.8984375
    epochs 589: acc = 0.9296875
    epochs 590: acc = 0.828125
    epochs 591: acc = 0.8984375
    epochs 592: acc = 0.8828125
    epochs 593: acc = 0.9453125
    epochs 594: acc = 0.859375
    epochs 595: acc = 0.875
    epochs 596: acc = 0.9140625
    epochs 597: acc = 0.890625
    epochs 598: acc = 0.84375
    epochs 599: acc = 0.890625
    epochs 600: acc = 0.875
    epochs 601: acc = 0.890625
    epochs 602: acc = 0.8203125
    epochs 603: acc = 0.921875
    epochs 604: acc = 0.90625
    epochs 605: acc = 0.8828125
    epochs 606: acc = 0.8984375
    epochs 607: acc = 0.8828125
    epochs 608: acc = 0.8828125
    epochs 609: acc = 0.90625
    epochs 610: acc = 0.8828125
    epochs 611: acc = 0.9296875
    epochs 612: acc = 0.90625
    epochs 613: acc = 0.9140625
    epochs 614: acc = 0.8984375
    epochs 615: acc = 0.8984375
    epochs 616: acc = 0.890625
    epochs 617: acc = 0.90625
    epochs 618: acc = 0.9375
    epochs 619: acc = 0.8984375
    epochs 620: acc = 0.953125
    epochs 621: acc = 0.90625
    epochs 622: acc = 0.890625
    epochs 623: acc = 0.8984375
    epochs 624: acc = 0.8125
    epochs 625: acc = 0.890625
    epochs 626: acc = 0.890625
    epochs 627: acc = 0.875
    epochs 628: acc = 0.9296875
    epochs 629: acc = 0.90625
    epochs 630: acc = 0.953125
    epochs 631: acc = 0.8828125
    epochs 632: acc = 0.828125
    epochs 633: acc = 0.8828125
    epochs 634: acc = 0.90625
    epochs 635: acc = 0.84375
    epochs 636: acc = 0.890625
    epochs 637: acc = 0.9140625
    epochs 638: acc = 0.8984375
    epochs 639: acc = 0.90625
    epochs 640: acc = 0.890625
    epochs 641: acc = 0.8671875
    epochs 642: acc = 0.90625
    epochs 643: acc = 0.8828125
    epochs 644: acc = 0.8515625
    epochs 645: acc = 0.921875
    epochs 646: acc = 0.90625
    epochs 647: acc = 0.90625
    epochs 648: acc = 0.9140625
    epochs 649: acc = 0.9375
    epochs 650: acc = 0.90625
    epochs 651: acc = 0.8828125
    epochs 652: acc = 0.90625
    epochs 653: acc = 0.890625
    epochs 654: acc = 0.90625
    epochs 655: acc = 0.8984375
    epochs 656: acc = 0.90625
    epochs 657: acc = 0.8671875
    epochs 658: acc = 0.9140625
    epochs 659: acc = 0.859375
    epochs 660: acc = 0.8984375
    epochs 661: acc = 0.8984375
    epochs 662: acc = 0.8984375
    epochs 663: acc = 0.8671875
    epochs 664: acc = 0.8984375
    epochs 665: acc = 0.890625
    epochs 666: acc = 0.84375
    epochs 667: acc = 0.8828125
    epochs 668: acc = 0.90625
    epochs 669: acc = 0.875
    epochs 670: acc = 0.921875
    epochs 671: acc = 0.90625
    epochs 672: acc = 0.875
    epochs 673: acc = 0.890625
    epochs 674: acc = 0.8359375
    epochs 675: acc = 0.9375
    epochs 676: acc = 0.9453125
    epochs 677: acc = 0.8515625
    epochs 678: acc = 0.8828125
    epochs 679: acc = 0.9453125
    epochs 680: acc = 0.9140625
    epochs 681: acc = 0.875
    epochs 682: acc = 0.90625
    epochs 683: acc = 0.921875
    epochs 684: acc = 0.8984375
    epochs 685: acc = 0.8984375
    epochs 686: acc = 0.90625
    epochs 687: acc = 0.859375
    epochs 688: acc = 0.921875
    epochs 689: acc = 0.9140625
    epochs 690: acc = 0.9140625
    epochs 691: acc = 0.875
    epochs 692: acc = 0.890625
    epochs 693: acc = 0.8984375
    epochs 694: acc = 0.9140625
    epochs 695: acc = 0.8984375
    epochs 696: acc = 0.921875
    epochs 697: acc = 0.9296875
    epochs 698: acc = 0.859375
    epochs 699: acc = 0.90625
    epochs 700: acc = 0.890625
    epochs 701: acc = 0.890625
    epochs 702: acc = 0.8984375
    epochs 703: acc = 0.921875
    epochs 704: acc = 0.9453125
    epochs 705: acc = 0.8984375
    epochs 706: acc = 0.9375
    epochs 707: acc = 0.84375
    epochs 708: acc = 0.90625
    epochs 709: acc = 0.890625
    epochs 710: acc = 0.890625
    epochs 711: acc = 0.9140625
    epochs 712: acc = 0.8515625
    epochs 713: acc = 0.8515625
    epochs 714: acc = 0.921875
    epochs 715: acc = 0.921875
    epochs 716: acc = 0.953125
    epochs 717: acc = 0.9375
    epochs 718: acc = 0.8984375
    epochs 719: acc = 0.90625
    epochs 720: acc = 0.9296875
    epochs 721: acc = 0.8828125
    epochs 722: acc = 0.875
    epochs 723: acc = 0.875
    epochs 724: acc = 0.8984375
    epochs 725: acc = 0.890625
    epochs 726: acc = 0.8828125
    epochs 727: acc = 0.8828125
    epochs 728: acc = 0.9140625
    epochs 729: acc = 0.90625
    epochs 730: acc = 0.8828125
    epochs 731: acc = 0.8984375
    epochs 732: acc = 0.921875
    epochs 733: acc = 0.8828125
    epochs 734: acc = 0.9140625
    epochs 735: acc = 0.8984375
    epochs 736: acc = 0.8671875
    epochs 737: acc = 0.8828125
    epochs 738: acc = 0.8828125
    epochs 739: acc = 0.9375
    epochs 740: acc = 0.9140625
    epochs 741: acc = 0.9296875
    epochs 742: acc = 0.9140625
    epochs 743: acc = 0.9296875
    epochs 744: acc = 0.9375
    epochs 745: acc = 0.859375
    epochs 746: acc = 0.9375
    epochs 747: acc = 0.84375
    epochs 748: acc = 0.921875
    epochs 749: acc = 0.859375
    epochs 750: acc = 0.8984375
    epochs 751: acc = 0.8828125
    epochs 752: acc = 0.9609375
    epochs 753: acc = 0.9140625
    epochs 754: acc = 0.9140625
    epochs 755: acc = 0.9375
    epochs 756: acc = 0.8984375
    epochs 757: acc = 0.9296875
    epochs 758: acc = 0.8984375
    epochs 759: acc = 0.8984375
    epochs 760: acc = 0.921875
    epochs 761: acc = 0.9140625
    epochs 762: acc = 0.9375
    epochs 763: acc = 0.9453125
    epochs 764: acc = 0.8828125
    epochs 765: acc = 0.8828125
    epochs 766: acc = 0.890625
    epochs 767: acc = 0.8984375
    epochs 768: acc = 0.875
    epochs 769: acc = 0.9296875
    epochs 770: acc = 0.859375
    epochs 771: acc = 0.8828125
    epochs 772: acc = 0.8828125
    epochs 773: acc = 0.8984375
    epochs 774: acc = 0.890625
    epochs 775: acc = 0.890625
    epochs 776: acc = 0.8828125
    epochs 777: acc = 0.9296875
    epochs 778: acc = 0.90625
    epochs 779: acc = 0.890625
    epochs 780: acc = 0.8828125
    epochs 781: acc = 0.8984375
    epochs 782: acc = 0.890625
    epochs 783: acc = 0.8984375
    epochs 784: acc = 0.9296875
    epochs 785: acc = 0.921875
    epochs 786: acc = 0.921875
    epochs 787: acc = 0.8984375
    epochs 788: acc = 0.890625
    epochs 789: acc = 0.90625
    epochs 790: acc = 0.9296875
    epochs 791: acc = 0.8984375
    epochs 792: acc = 0.8828125
    epochs 793: acc = 0.875
    epochs 794: acc = 0.8984375
    epochs 795: acc = 0.921875
    epochs 796: acc = 0.9296875
    epochs 797: acc = 0.8984375
    epochs 798: acc = 0.8828125
    epochs 799: acc = 0.8828125
    epochs 800: acc = 0.875
    epochs 801: acc = 0.8984375
    epochs 802: acc = 0.8828125
    epochs 803: acc = 0.8984375
    epochs 804: acc = 0.9296875
    epochs 805: acc = 0.9140625
    epochs 806: acc = 0.90625
    epochs 807: acc = 0.9609375
    epochs 808: acc = 0.890625
    epochs 809: acc = 0.9375
    epochs 810: acc = 0.890625
    epochs 811: acc = 0.8828125
    epochs 812: acc = 0.875
    epochs 813: acc = 0.8984375
    epochs 814: acc = 0.875
    epochs 815: acc = 0.9140625
    epochs 816: acc = 0.9140625
    epochs 817: acc = 0.890625
    epochs 818: acc = 0.9375
    epochs 819: acc = 0.875
    epochs 820: acc = 0.875
    epochs 821: acc = 0.890625
    epochs 822: acc = 0.859375
    epochs 823: acc = 0.9296875
    epochs 824: acc = 0.9375
    epochs 825: acc = 0.9296875
    epochs 826: acc = 0.953125
    epochs 827: acc = 0.90625
    epochs 828: acc = 0.9296875
    epochs 829: acc = 0.8984375
    epochs 830: acc = 0.9140625
    epochs 831: acc = 0.890625
    epochs 832: acc = 0.921875
    epochs 833: acc = 0.9375
    epochs 834: acc = 0.9140625
    epochs 835: acc = 0.84375
    epochs 836: acc = 0.90625
    epochs 837: acc = 0.9296875
    epochs 838: acc = 0.9375
    epochs 839: acc = 0.90625
    epochs 840: acc = 0.875
    epochs 841: acc = 0.921875
    epochs 842: acc = 0.90625
    epochs 843: acc = 0.90625
    epochs 844: acc = 0.9296875
    epochs 845: acc = 0.921875
    epochs 846: acc = 0.890625
    epochs 847: acc = 0.859375
    epochs 848: acc = 0.9375
    epochs 849: acc = 0.9140625
    epochs 850: acc = 0.921875
    epochs 851: acc = 0.8984375
    epochs 852: acc = 0.9296875
    epochs 853: acc = 0.90625
    epochs 854: acc = 0.9296875
    epochs 855: acc = 0.9140625
    epochs 856: acc = 0.96875
    epochs 857: acc = 0.921875
    epochs 858: acc = 0.9296875
    epochs 859: acc = 0.9140625
    epochs 860: acc = 0.8828125
    epochs 861: acc = 0.9375
    epochs 862: acc = 0.890625
    epochs 863: acc = 0.921875
    epochs 864: acc = 0.8984375
    epochs 865: acc = 0.9375
    epochs 866: acc = 0.8828125
    epochs 867: acc = 0.8828125
    epochs 868: acc = 0.8984375
    epochs 869: acc = 0.8984375
    epochs 870: acc = 0.859375
    epochs 871: acc = 0.90625
    epochs 872: acc = 0.9296875
    epochs 873: acc = 0.9375
    epochs 874: acc = 0.921875
    epochs 875: acc = 0.8828125
    epochs 876: acc = 0.9140625
    epochs 877: acc = 0.9453125
    epochs 878: acc = 0.9140625
    epochs 879: acc = 0.9296875
    epochs 880: acc = 0.90625
    epochs 881: acc = 0.8984375
    epochs 882: acc = 0.9140625
    epochs 883: acc = 0.9375
    epochs 884: acc = 0.9453125
    epochs 885: acc = 0.90625
    epochs 886: acc = 0.9453125
    epochs 887: acc = 0.9453125
    epochs 888: acc = 0.8828125
    epochs 889: acc = 0.9140625
    epochs 890: acc = 0.9375
    epochs 891: acc = 0.9453125
    epochs 892: acc = 0.8828125
    epochs 893: acc = 0.8984375
    epochs 894: acc = 0.9453125
    epochs 895: acc = 0.890625
    epochs 896: acc = 0.875
    epochs 897: acc = 0.9609375
    epochs 898: acc = 0.9453125
    epochs 899: acc = 0.9140625
    epochs 900: acc = 0.921875
    epochs 901: acc = 0.9296875
    epochs 902: acc = 0.921875
    epochs 903: acc = 0.90625
    epochs 904: acc = 0.9609375
    epochs 905: acc = 0.953125
    epochs 906: acc = 0.859375
    epochs 907: acc = 0.890625
    epochs 908: acc = 0.953125
    epochs 909: acc = 0.9296875
    epochs 910: acc = 0.875
    epochs 911: acc = 0.8828125
    epochs 912: acc = 0.9609375
    epochs 913: acc = 0.8984375
    epochs 914: acc = 0.9375
    epochs 915: acc = 0.9375
    epochs 916: acc = 0.9453125
    epochs 917: acc = 0.890625
    epochs 918: acc = 0.90625
    epochs 919: acc = 0.90625
    epochs 920: acc = 0.8984375
    epochs 921: acc = 0.8984375
    epochs 922: acc = 0.8671875
    epochs 923: acc = 0.9375
    epochs 924: acc = 0.875
    epochs 925: acc = 0.8671875
    epochs 926: acc = 0.921875
    epochs 927: acc = 0.9375
    epochs 928: acc = 0.8828125
    epochs 929: acc = 0.90625
    epochs 930: acc = 0.90625
    epochs 931: acc = 0.890625
    epochs 932: acc = 0.890625
    epochs 933: acc = 0.921875
    epochs 934: acc = 0.8359375
    epochs 935: acc = 0.9140625
    epochs 936: acc = 0.921875
    epochs 937: acc = 0.921875
    epochs 938: acc = 0.8828125
    epochs 939: acc = 0.8984375
    epochs 940: acc = 0.9375
    epochs 941: acc = 0.8828125
    epochs 942: acc = 0.8984375
    epochs 943: acc = 0.8984375
    epochs 944: acc = 0.9453125
    epochs 945: acc = 0.875
    epochs 946: acc = 0.90625
    epochs 947: acc = 0.9296875
    epochs 948: acc = 0.8984375
    epochs 949: acc = 0.8984375
    epochs 950: acc = 0.96875
    epochs 951: acc = 0.8984375
    epochs 952: acc = 0.8984375
    epochs 953: acc = 0.921875
    epochs 954: acc = 0.8984375
    epochs 955: acc = 0.9140625
    epochs 956: acc = 0.90625
    epochs 957: acc = 0.8828125
    epochs 958: acc = 0.859375
    epochs 959: acc = 0.90625
    epochs 960: acc = 0.9296875
    epochs 961: acc = 0.921875
    epochs 962: acc = 0.8671875
    epochs 963: acc = 0.890625
    epochs 964: acc = 0.8984375
    epochs 965: acc = 0.890625
    epochs 966: acc = 0.90625
    epochs 967: acc = 0.921875
    epochs 968: acc = 0.890625
    epochs 969: acc = 0.9296875
    epochs 970: acc = 0.9296875
    epochs 971: acc = 0.8984375
    epochs 972: acc = 0.890625
    epochs 973: acc = 0.9140625
    epochs 974: acc = 0.9140625
    epochs 975: acc = 0.8984375
    epochs 976: acc = 0.890625
    epochs 977: acc = 0.8828125
    epochs 978: acc = 0.8828125
    epochs 979: acc = 0.9453125
    epochs 980: acc = 0.8671875
    epochs 981: acc = 0.8984375
    epochs 982: acc = 0.9140625
    epochs 983: acc = 0.9296875
    epochs 984: acc = 0.90625
    epochs 985: acc = 0.8984375
    epochs 986: acc = 0.9453125
    epochs 987: acc = 0.8984375
    epochs 988: acc = 0.8515625
    epochs 989: acc = 0.859375
    epochs 990: acc = 0.8828125
    epochs 991: acc = 0.890625
    epochs 992: acc = 0.9296875
    epochs 993: acc = 0.9375
    epochs 994: acc = 0.9140625
    epochs 995: acc = 0.90625
    epochs 996: acc = 0.8671875
    epochs 997: acc = 0.8984375
    epochs 998: acc = 0.9140625
    epochs 999: acc = 0.90625



```python

```
